---
status: resolved
phase: 02.1-add-turbo
source: 02.1-01-SUMMARY.md, 02.1-02-SUMMARY.md, 02.1-03-SUMMARY.md
started: 2026-02-22T20:30:00Z
---

## Current Test

number: complete
name: All tests passed
awaiting: none

## Tests

### 1. Turbo Dev — Both Apps Start
expected: From repo root, run `npm run dev` (which calls `turbo run dev`). Both the Vite frontend (port 5173) and the FastAPI backend (port 8000) start simultaneously in a single terminal with turbo-style colored output. Both apps are reachable: http://localhost:5173 shows the parchment UI, http://localhost:8000/api/v1/health returns JSON.
result: pass

### 2. Turbo Build — Full Pipeline
expected: From repo root, run `npm run build`. Turbo runs typecheck first (since build depends on typecheck in turbo.json), then builds the frontend. No errors. The build completes with turbo caching info shown.
result: pass
note: "Initially failed — fixed inline: (1) removed unused `pathlib.Path` import in backend batches.py (ruff F401), (2) upgraded tsconfig lib ES2022→ES2023 for Array.findLast support, (3) fixed ColumnDef<ResultRow, unknown> type to any for TanStack Table column array, (4) removed unused `_id` param in TemplateSelector, (5) removed unused `successCount` in ResultsStep, (6) removed unused `batchName` prop from ResultsTable after thumbnail column removal."

### 3. Turbo Typecheck
expected: From repo root, run `npm run typecheck`. TypeScript type checking runs across all workspaces. No type errors reported.
result: pass

### 4. Shared Types Codegen
expected: From repo root, run `turbo run generate`. The codegen script in packages/shared-types regenerates TypeScript interfaces from the JSON Schema files. The file `packages/shared-types/generated/ts/index.ts` is updated (or unchanged if schemas haven't changed). No errors.
result: pass

### 5. Workspace Filtering
expected: Run `turbo run dev --filter=frontend`. Only the Vite frontend starts (port 5173) — the backend does NOT start. Turbo output shows only the frontend workspace. You can also try `turbo run dev --filter=backend` to start only the backend.
result: pass

### 6. Shared Types Import
expected: Open `packages/shared-types/generated/ts/index.ts` and confirm it contains TypeScript interfaces (BatchConfig, BatchProgress, HealthCheck, etc.). These types are importable from `@indexcards/shared-types` in the frontend code.
result: pass

### 7. Setup Script
expected: Run `npm run setup` from repo root. The script checks for `uv`, creates/reuses a Python venv, installs Python dependencies, runs `npm install`, and warns if `.env` is missing. It completes without errors.
result: pass

## Summary

total: 7
passed: 7
issues: 1
pending: 0
skipped: 0

## Gaps

- truth: "turbo run build completes without errors across all workspaces"
  status: resolved
  reason: "Build failed due to: (1) unused pathlib.Path import in backend batches.py (ruff F401), (2) tsconfig lib ES2022 missing Array.findLast (ES2023), (3) ColumnDef type mismatch in ResultsTable, (4) unused variables from previous refactors (TemplateSelector id, ResultsStep successCount, ResultsTable batchName)"
  severity: major
  test: 2
  root_cause: "Strict linting (ruff) and strict TypeScript (noUnusedLocals, noUnusedParameters) caught dead code left behind from earlier phase refactors. Vite dev server doesn't run tsc so these went unnoticed."
  artifacts: ["batches.py", "tsconfig.app.json", "TemplateSelector.tsx", "ResultsStep.tsx", "ResultsTable.tsx"]
  fix: "Removed unused imports/variables, upgraded lib to ES2023, widened ColumnDef generic to any."
